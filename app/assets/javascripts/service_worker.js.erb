var cacheName = 'tectonic-cache-12-02-1800';
var filesToCache = [
'/images/plates/al.jpg',
'/images/plates/ak.jpg',
'/images/plates/az.jpg',
'/images/plates/ar.jpg',
'/images/plates/ca.jpg',
'/images/plates/co.jpg',
'/images/plates/ct.jpg',
'/images/plates/de.jpg',
'/images/plates/dc.jpg',
'/images/plates/fl.jpg',
'/images/plates/ga.jpg',
'/images/plates/hi.jpg',
'/images/plates/id.jpg',
'/images/plates/il.jpg',
'/images/plates/in.jpg',
'/images/plates/ia.jpg',
'/images/plates/ks.jpg',
'/images/plates/ky.jpg',
'/images/plates/la.jpg',
'/images/plates/me.jpg',
'/images/plates/md.jpg',
'/images/plates/ma.jpg',
'/images/plates/mi.jpg',
'/images/plates/mn.jpg',
'/images/plates/ms.jpg',
'/images/plates/mo.jpg',
'/images/plates/mt.jpg',
'/images/plates/ne.jpg',
'/images/plates/nv.jpg',
'/images/plates/nh.jpg',
'/images/plates/nj.jpg',
'/images/plates/nm.jpg',
'/images/plates/ny.jpg',
'/images/plates/nc.jpg',
'/images/plates/nd.jpg',
'/images/plates/oh.jpg',
'/images/plates/ok.jpg',
'/images/plates/or.jpg',
'/images/plates/pa.jpg',
'/images/plates/ri.jpg',
'/images/plates/sc.jpg',
'/images/plates/sd.jpg',
'/images/plates/tn.jpg',
'/images/plates/tx.jpg',
'/images/plates/ut.jpg',
'/images/plates/vt.jpg',
'/images/plates/va.jpg',
'/images/plates/wa.jpg',
'/images/plates/wv.jpg',
'/images/plates/wi.jpg',
'/images/plates/wy.jpg',
'/images/plates-header.png',
'<%= asset_path "application.js" %>',
'<%= asset_path "application.css" %>',
'/offline.html'
];

self.addEventListener('install', function(e) {
  console.log('[ServiceWorker] Install');
  e.waitUntil(
    caches.open(cacheName).then(function(cache) {
      console.log('[ServiceWorker] Caching app shell');
      return cache.addAll(filesToCache);
    })
  );
});

self.addEventListener('activate', function(e) {
  console.log('[ServiceWorker] Activate');
  e.waitUntil(
    caches.keys().then(function(keyList) {
      return Promise.all(keyList.map(function(key) {
        if (key !== cacheName && key !== dataCacheName) {
          console.log('[ServiceWorker] Removing old cache', key);
          return caches.delete(key);
        }
      }));
    })
  );
  return self.clients.claim();
});

self.addEventListener('fetch', function(e) {
  // console.log('[Service Worker] Fetch', e.request.url);

    e.respondWith(
      caches.match(e.request).then(function(response) {
        return response || fetch(e.request);
      }).catch(function() {
      return caches.match('/offline.html');
    })
    );

});
